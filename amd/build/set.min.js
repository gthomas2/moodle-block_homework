define(["jquery","theme_bootstrapbase/bootstrap","block_homework/jquery.sumoselect","block_homework/bootstrap-switch","block_homework/zebra_tooltips","block_homework/select2","block_homework/datepicker","block_homework/form_validate","block_homework/util"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(){var b,c=function(){if(b=M.str.block_homework,0!==a("#ond_form").length){if(a("#btncancel").on("click",d),a("#btnsubmit").click(function(){h.validateInputs(e)}),a("#selectcourse").length>0)return a("#btnsubmit").html("Next"),void a("#selectcourse").attr("style","width:30%").select2();if(a(".ond_subgroupcontroller").change(function(){var b=a(this),c=a("#"+b.attr("id")+"_subgroup_on"),d=a("#"+b.attr("id")+"_subgroup_off");b.prop("checked")||0===b[0].selectedIndex?(c.fadeIn(),d.fadeOut()):(c.fadeOut(),d.fadeIn())}).change(),a.fn.bootstrapSwitch&&a("input[type=checkbox][data-toggle=toggle]").bootstrapSwitch({handleWidth:40,labelWidth:1,onText:b.on,offText:b.off}),a("#groups").attr("multiple")&&a("#groups").SumoSelect({csvDispCount:5,placeholder:b.nogrouprestriction,selectAll:!0,captionFormatAllSelected:b.allxselected,search:!0}),a("#users").attr("multiple")&&a("#users").SumoSelect({csvDispCount:5,placeholder:b.nouserrestriction,selectAll:!0,captionFormatAllSelected:b.allxselected,search:!0}),a.fn.datepicker){var c={autoHide:!0,autoPick:!0,format:a("#dateformat").val(),date:new Date(Date.parse(a("#due").val())),weekStart:1};a("#due").datepicker(c),c.date=new Date(Date.parse(a("#available").val())),a("#available").datepicker(c)}new a.Zebra_Tooltips(a(".tooltips"),{background_color:"oldlace",color:"black",opacity:"1"})}};this.start=function(){var a=function(){return"undefined"!=typeof M&&"undefined"!=typeof M.str&&"undefined"!=typeof M.str.block_homework};i.whenTrue(a,c,!0,20)};var d=function(){var b=M.cfg.wwwroot,c=a("#course").val();"undefined"!=typeof c&&(b+="/course/view.php?id="+c),window.location=b},e=function(c){var d="";if("due"==c.attr("id")&&a("#due").datepicker("getDate")<=a("#available").datepicker("getDate")&&(d=b.duedateinvalid),("users"==c.attr("id")||"groups"==c.attr("id"))&&"1"==a("#reqrestrict").val()){var e=0,f=0,g=a("#users"),h=a("#groups"),i=!1,j=!1;if(void 0!=typeof g&&"select-multiple"==g.prop("type")){i=!0;var k=g.val();null!=k&&(e=k.length)}if(void 0!=typeof h&&"select-multiple"==g.prop("type")){j=!0;var l=h.val();null!=l&&(f=l.length)}0==e&&0==f&&(i||j)&&(d=b.mustrestrict)}return d}};return new j});